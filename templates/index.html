{% extends "layout.html" %}

{% block title %}
  Home
{% endblock %}

{% block main %}
    <h1 style="font-weight: bold;">Welcome to H-Vault!</h1>
    <h4 style="color: #2C5364;">Your secure vault for your passwords</h4>
    <div style="margin-top: 80px; margin-bottom: 40px;"> 
        <a href="/add_account" class="btn btn-outline-success" style="width: 320px;">Add New Account</a>
    </div>

    <div style="background-color: lightgrey;  width: 100%; margin-bottom: 40px; border-radius: 10px;">
        <h1 style="padding-top: 20px; font-weight: 900;">Accounts</h1>
        <div style="display: flex; flex-direction: column; text-align: left; gap: 15px; margin-top: 40px; padding-bottom: 60px; padding-left: 60px;">
            {% if accounts %}
                {% for account in accounts %}
                    <h3 style="font-weight: bold; display: flex; align-items: center; justify-content: space-between; cursor: pointer; padding: 10px; margin-left: -40px;"
                        onclick="toggleAccount('{{ account.id }}')">
                        {{ account.platform }}
                        <button type="button" class="btn" style="all: unset; cursor: pointer;">
                            <img id="arrow-{{ account.id }}" src="{{ url_for('static', filename='arrow.png') }}" 
                                alt="Toggle Details" style="max-width: 30px; margin-left: 10px; transition: transform 0.3s; margin-right: 25px;">
                        </button>
                    </h3>

                    <div style="display: none;" id="account-{{ account.id }}">
                        <p style="margin: 5px 0; padding-left: 20px;"><strong>Username:</strong> {{ account.account_username }}</p>
                        <p style="margin: 5px 0; padding-left: 20px;"><strong>Password:</strong> {{ account.password_encrypted }}</p>

                        <form action="/delete_account" method="POST" style="margin-top: 10px; padding-left: 20px;" onsubmit="return confirm('Are you sure you want to delete this account?');">
                          <input type="hidden" name="account_id" value="{{ account.id }}">
                          <button type="submit" class="btn btn-outline-danger" style="margin-top: 20px;">Delete This Account</button>
                        </form>
                    </div>

                      <hr style="width: 100%; margin-left: -40px;">

                    <script>
                    function toggleAccount(id) {
                        const acc = document.getElementById('account-' + id);
                        const arrow = document.getElementById('arrow-' + id);

                        if (acc.style.display === 'none' || acc.style.display === '') {
                            acc.style.display = 'block';
                            arrow.style.transform = 'rotate(180deg)'; 
                        } else {
                            acc.style.display = 'none';
                            arrow.style.transform = 'rotate(0deg)'; 
                        }
                    }
                    </script>
                {% endfor %}
            {% else %}
            <p style="font-weight: bold;">No accounts stored yet.</p>
            {% endif %}
        </div>

    </div>

    <div>
      {% if accounts %}
        <form action="/clear" method="post" onsubmit="return confirm('Are you sure you want to clear all accounts? You will not be able to get them back again.');">
            <button type="submit" class="btn btn-outline-danger" style="width: 320px; margin-bottom: 40px;">Clear All Accounts</button> 
        </form>
      {% endif %}
    </div>
  
{% endblock %}
